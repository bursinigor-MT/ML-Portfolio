# README.md

## О задаче
Необходимо было решить задачу прогноза оттока клиентов -- определить,  останется ли клиент пользователем сервиса или нет, то есть требовалось решить задачу бинарной классификации.
В процессе решения задачи были проведен EDA, выполнена  предобработка данных и построены разнородные модели.
Финальный результат составил ROC-AUC = **76.31%**.

## Предобработка и EDA

### Краткий обзор:
1. Дисбаланс классов -- примерно 3 раза.
2. В данных нет пропусков.

### EDA числовых признаков

1. `ClientPeriod` -- клиенты имеют меньший период использования услуг, оставшиеся клиенты имеют больший разброс в использовании и в целом нормально распределены. Ушедшие клиенты имеют выбросы -- выбросы были удалены.
2. `MonthlySpending` и `TotalSpent` -- ушедшие клиенты тратили больше, чем оставшиеся. У оставшихся клиентов размах трат шире, есть как более экономные, так и более расточительные клиенты. В целом, у ушедших клиентов диапазон трат меньше.

### EDA бинарные признаки

1. Клиенты с электронным счетом чаще отказываются от услуг
2. Клиенты с детьми чаще отказыватся от услуг, но их и меньше, чем клиенов без детей
3. Клиенты с партнетом реже отказываются от услуг
4. Клиентов с подключенной телефонной связью значительно больше остальных категорий.
5. Пожилые клиенты чаще отказываются от услуг, более молодые клиенты, в свою очередь, реже отказываются.

`HasPhoneService` -- неиформативен, поскольку очень сильный дисбаланс классов.

### EDA категориальные признаки

1. Клиенты с оптоволоконным соединением чаще отказываются от услуг, клиенты с DSL реже отказываются, а клиенты без интернета и вовсе почти не отказываются.
2. Клиенты без телефона чаще остаются. но их мало, признак довольно слабый.
3. Опять же люди без интернета остаются гораздо чаще, но это непоказательно. А вот если интернет подключен, то отток без защиты гораздо сильнее, когда в свою очередь клиенты с защитой очень редко отказываются от услуг.
4. Такая же логика, что и в пункте выше для: `HasOnlineBackup`, `HasDeviceProtection`, `HasTechSupportAccess`, `HasOnlineTV`, `HasMovieSubscription`.
5. Услуги в онлайн снижают вероятность оттока. 
6. Месячный контракт -- максимальный риск оттока. Годовой контракт и более -- отток минимален.

Можно сделать один серьезный вывод: наличие дополнительных услуг снижает вероятность ухода.

---

## Кодирование категориальных переменных
Для признаков: `HasInternetService`, `HasMultiplePhoneNumbers`, `HasOnlineSecurityService`, `HasOnlineBackup`, `HasDeviceProtection`,`HasTechSupportAccess`,`HasOnlineTV`, `HasMovieSubscription`, `HasContractPhone`, можно использовать следующую кодировку: 
- отсутствие услуги → -1
- наличие базовой услуги → 0
- наличие дополнительной услуги → 1
Поскольку в данных действительно есть логический порядок, такой подход оправдан.

---

## Модели и результаты 

Лучше всего себя показали XGBoost и стекинг 5 моделей с финальной моделью -- логистической регрессией, вариант с финальной моделью SVM показал себя чуть хуже. Также себя в целом довольно неплохо показала логистическая регрессия поскольку в данных прослеживается явная линейная зависимость.
XGBoost выделил как минимум три наиболее важные фичи: `HasContractPhone`, `HasInternetService`, `MonSpenPer`.

- Признак `HasContractPhone` для модели XGBoost является ключевым признаком. Важность этого признака довольно легко объясняется, поскольку еще на этапе EDA было замечено, что отток клиентов с месячным контрактом сильно выше, то есть, тип контракта чуть ли не лучший способ манипуляции лояльностью. 
- Важность `HasInternetService` можно объяснить так: разные типа интернета означает разное качество услуги, что влечет за собой разную удовлетворенность. 
- `MonSpenPer` вероятнее всего означает, что клиенты с высокой долей платежей чаще уходят.

---

## Возможные улучшения

- Random Forest был очень плохо настроен, возможно есть потенциал роста точности для случайного леса, так и для стекинга при подборке гиперпараметров.
- Можно более чательно обработать данные, например, более чательно обработать признаки с слабым сигналом или удалить их,или создать больше производных признаков -- все это вероятнее всего повысит качество XGBoost или стекинга.

---
